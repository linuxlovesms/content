{name}Vladimir Yunev{/name}{company}Microsoft{/company}{title}Развертывание NGINX на Microsoft Azure{/title}{cat}0{/cat}{date}12.04.2016{/date}{desc}Развертывание NGINX на Microsoft Azure{/desc}

Разработчики, которые создают решения с помощью NGINX могут легко
размещать свои решения в облачной платформе Microsoft Azure. Проще всего
это сделать с помощью виртуальных машин.

Для упрощения работы с виртуальными машинами в облаке Azure предлагается
площадка Azure Marketplace, в которой находятся сотни заранее
настроенных виртуальных машин с разным окружением и установленными
инструментами, включая операционные системы, базы данных, среды,
фреймворки, CMS и так далее.

Рассмотрим, как любой пользователь Azure может развернуть NGINX за
несколько минут.

Поиск NGINX в Azure Marketplace
===============================

> *Подразумевается, что у вас уже есть учетная запись Microsoft Azure.
> Если это не так, то воспользуйтесь бесплатным [триал-предложением по
> этой ссылке](https://azure.microsoft.com/ru-ru/free/).*

Перейдите на портал Microsoft Azure по ссылке <http://portal.azure.com>,
вы откроете панель управления облачными мощностями Microsoft Azure,
предоставленными вам по запросу (рисунок 1).

![](https://github.com/linuxlovesms/content/media/nginx1.png)

*Рис.1 – Портал Microsoft Azure*

Нажмите на кнопку «Создать» для добавления нового компонента в свою
учетную запись. В нашем случае мы намереваемся добавить виртуальную
машину с NGINX. Введите в строку поиска NGINX. Вы получите полный список
доступных в Azure Marketplace конфигураций NGINX на выбор (рисунок 2).

![](https://github.com/linuxlovesms/content/media/nginx2.png)

*Рис.2. – Список NGINX в Azure Marketplace*

Вы можете выбрать из большого числа вариантов: NGINX Stack, NGINX Plus –
с коммерческой поддержкой, nginx в виде контейнера Docker и так далее.
Выберите NGINX Stack и в новом информационном окне нажмите кнопку
«Создать». Теперь вы перейдете к непосредственному созданию виртуальной
машины, выбранной из Azure Marketplace (рисунок 3).

![](https://github.com/linuxlovesms/content/media/nginx3.png)

*Рис.3. – Создание виртуальной машины*

Создание VM с NGINX
===================

Чтобы создать виртуальную машину, в нашем случае с NGINX на борту,
необходимо указать ряд параметров. В первую очередь ввести название
виртуальной машины. Затем имя пользователя (администратора) и пароль
доступа. Выбрать подписку Azure, если у вас их несколько.

Важный параметр, который необходимо указать – это группа ресурсов. В
целом, группа ресурсов – это просто объединение разных облачных ресурсов
– VM, хранилища, сетей – под одним именем для упрощения
администрирования. Поэтому, на данном этапе просто введите название для
группы.

Последний параметр, который нужно указать на первом шаге – расположение
виртуальной машины – по существу выбор одного из ЦОД Microsoft Azure,
которые расположены по всему миру. Ближайшие к России ЦОД – это Северная
или Западная Европа. Выберите один из них.

![](https://github.com/linuxlovesms/content/media/nginx4.png)}

*Рис.4. – Параметры первого шага создания виртуальной машины*

Нажмите «ОК» после ввода всех параметров. На втором шаге вам предложат
выбрать размер виртуальный машины. По умолчанию будут представлены
несколько типов машин, которые рекомендуются для данного типа решения.
Но вы всегда можете выбрать другой размер нажав на «Просмотреть все»
(рисунок 4).

![](https://github.com/linuxlovesms/content/media/nginx5.png)

*Рис.4. – Выбор размера виртуальной машины*

Я предлагаю выбрать вам размер «A1 Базовый» как подходящий для
тестирования. После выбора нажмите кнопку «Выбрать», чтобы перейти к
третьему шагу.

На третьем шаге производится тонкая настройка развертывания. Здесь все
параметры можно оставить по умолчанию и вообще ничего не менять. Но если
требуется, что вы можете выбрать SSD-хранилище для VM, настроить
виртуальную сеть, безопасность, включить мониторинг, создать группу
доступности для отказоустойчивой работы VM (рисунок 5).

![](https://github.com/linuxlovesms/content/media/nginx6.png)

*Рис.5. – Тонкие настройки развертывания VM*

Нажмите «ОК» после тонкой настройки для того, чтобы перейти к финальным
шагам и запуску виртуальной машины.

Вы получите информационное окно с перечислением ваших настроек (рисунок
6).

![](https://github.com/linuxlovesms/content/media/nginx7.png)

*Рис.6. – Информационное окно с настройками*

Ознакомьтесь с информацией и нажмите «ОК» для того чтобы перейти к
приобретению виртуальной машины для своей подписки.

> ***Для информации.** Приобретение в данном случае означает создание VM
> с бесплатным ПО на нем. В Azure Marketplace есть продукты, которые
> могут потребовать приобретения лицензии на них.*

Прочитайте информацию о приобретении (рисунок 7). В нашем случае
содержание виртуальной машины стоит 0 рублей. Стоимость выбранной нами
самой VM, которую предоставить Microsoft Azure – около 3 р. в час.

![](https://github.com/linuxlovesms/content/media/nginx8.png)

*Рис.7. – Приобретение виртуальной машины*

Нажмите кнопку «Приобретение» для того чтобы запустить процесс
развертывания вашей виртуальной машины с NGINX Stack на борту.

Вы увидите информационное сообщение «Развертывание начато…» (рисунок 8).

![](https://github.com/linuxlovesms/content/media/nginx9.png)

*Рис.8. – Развертывание начато*

Как только VM будет готова вы получите еще одно информационное
сообщение, а на портале откроется панель управления созданной VM
(рисунок 9). В общем случае, создание виртуальной машины занимает
несколько минут.

![](https://github.com/linuxlovesms/content/media/nginx10.png)

*Рис.9. – Панель управления виртуальной машиной*

Поздравляю! Вы развернули свою машину с готовым NGINX.

Управление развернутой виртуальной машиной
==========================================

Для того чтобы убедиться в работоспособности виртуальной машины первым
делом мы можем перейти по ее общедоступному адресу.

Вы можете найти общедоступный адрес в заголовке панели
администрирования. В моем случае это <http://13.74.190.132/>. Перейдя по
этому адресу, мы увидим стандартное приветствие (рисунок 10).

![](https://github.com/linuxlovesms/content/media/nginx11.png)

*Рис.10 – Стандартное приветствие от запущенной в Azure машины с NGINX*

Данная виртуальная машина была подготовлена компанией Bitnami –
известным сборщиком готовых окружений. По приложенным ссылкам вы найдете
подробное описание установленной конфигурации и компонент NGINX (рисунок
11).

![](https://github.com/linuxlovesms/content/media/nginx12.png)

*Рис.11. – Описание NGINX-стека*

Вам может быть интересно то, как получить FQDN-адрес для своей машины в
виде доменного имени. По умолчанию для VM адрес не сопоставляется, но
его можно легко получить. Для этого перейдите в настройки VM (Все
параметры) на панели конфигурации. Затем выберите пункт «Конфигурация» и
в панели настройки укажите наименование для вашей VM, которое будет
включено в FDQN-путь (рисунок 12).

![](https://github.com/linuxlovesms/content/media/nginx13.png)

*Рис.12. – Добавление FDQN-пути для виртуальной машины*

После сохранения настроек вы сможете использовать ссылку, которая будет
представлена в виде (мой случай)
<http://vyunginx.northeurope.cloudapp.azure.com/>.

Этот же адрес вы теперь сможете использовать для доступа по SSH к вашей
виртуальной машине (рисунок 13), например:

*SSH vyunev@vyunginx.northeurope.cloudapp.azure.com*

где vyunev – имя пользователя (администратора), которое вы указали при
создании VM.

![](https://github.com/linuxlovesms/content/media/nginx14.png)

*Рис.13. – Подключение к виртуальной машине по SSH*

Теперь вы можете настроить вашу VM с NGINX так как душа пожелает!

Заключение
==========

Мы рассмотрели простой пример того, как с помощью Azure и площадки Azure
Marketplace за считанные минуты можно развернуть окружение NGINX и
получить доступ к готовой рабочей виртуальной машине.

Azure и Azure Marketplace предлагают запустить любые решения построенные
на любой технологии, в том числе для Linux и Windows. Вот лишь краткий
список того, что вы можете найти: NGINX Enterprise Linux, Oracle Linux,
CentOS, CoreOS, Ubuntu, Suse, WordPress, Moodle, NGINX, Jboss, Redmine,
SEO Panel, Parse, Git, GitLab, NGINX, ModX, Memcached, LAMP Stack,
Jenkins, Node.js, SugarCRM, Ruby Stack, Ghost, Subversion, ActiveMQ,
Nginx Stack, Solr, Tomcat, JRuby, OwnCloud, MySQL, Drupal, MongoDB,
Piwik, Dolibarr, LAAP Stack, OpenProject, Plone, eXo, Mahara, Zurmo,
RoundCube, Mautic, ThinkUp, Prestashop, Tracks, phpBB, eZ Publish,
Joomla…

Продолжайте использовать Azure и размещать в облаке свои
opensource-решения. Поможет вам в этом подробный раздел с документацией
и ресурсами [по этой
ссылке](https://azure.microsoft.com/ru-ru/documentation/services/virtual-machines/linux/).
